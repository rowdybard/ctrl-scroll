services:
  - type: web
    name: ctrl-scroll
    runtime: node
    plan: starter
    buildCommand: pnpm install
    startCommand: pnpm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: SITE_DIR
        value: /var/data/site
      - key: OPENAI_API_KEY
        sync: false
      - key: REDDIT_CLIENT_ID
        sync: false
      - key: REDDIT_CLIENT_SECRET
        sync: false
      - key: REDDIT_USERNAME
        value: CtrlScrollBot
      - key: ALLOWLIST_SUBS
        value: news,worldnews,technology,science,AskReddit
      - key: DENYLIST
        value: NSFW,leak
      - key: MAX_POSTS
        value: 5
      - key: MIN_SCORE
        value: 1
      - key: MAX_AGE_HOURS
        value: 168
      - key: USER_AGENT
        value: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36"
      - key: CRON_SECRET
        sync: false
      - key: SITE_URL
        value: https://ctrlscroll.onrender.com
      - key: AUTO_GENERATE
        value: true
    disk:
      name: site-storage
      mountPath: /var/data
      sizeGB: 2

# Optional: Add a cron job to trigger generation
# - type: cron
#   name: ctrl-scroll-generator
#   schedule: "0 */6 * * *"
#   runtime: node
#   buildCommand: pnpm install
#   startCommand: curl -H "x-cron: $CRON_SECRET" https://ctrlscroll.onrender.com/generate

